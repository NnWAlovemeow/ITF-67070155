<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITF-WEB</title>
    <link rel="stylesheet" href="lab14.css">
</head>

<body>
    <div class="center">

        <div class="profile" id="profile">
            <div class="notify">
                <p>1</p>
            </div>
        </div>
        <h1 id="user"> Username, ok</h1>
        <p>
            <label> Set Username </label><input type="text" id="name">
            <button onclick="setName()">set</button>
        </p>
        <p><label> Set Profile Image </label>
            <input type="text" id="img">
            <button onclick="setImg()"> Set </button>
        </p>
        <br>
        <p><b>
                <h2>Phone Number List</h2>
            </b></p>
        <div style="display : flex; gap: 10px; justify-content: center;">
            <input class="mb-4" type="text" id="phonename" placeholder="Name">
            <input class="mb-4" type="text" id="phone" placeholder="Tel">
            <button onclick="addPhone()" style="height: fit-content;"> ADD </button>
            <label>
                <button onclick="saveCSV()">EXPORT</button>
            </label>
        </div>
    </div>
    <table id="phonetable" border="1" style="width: 500px;" align="center">
        <tr>
            <th>No.</th>
            <th>Name</th>
            <th>phonenumber</th>
        </tr>
    </table>

    </div>

    <script>
        console.log("load script")
        const username = document.getElementById("user");
        const input = document.getElementById("name");
        const img = document.getElementById("img");
        const profile = document.getElementById("profile");
        const newdiv = document.getElementsByClassName("container")[0];

        function setName() {
            console.log("tset")
            username.textContent = input.value;
            input.value = "";
        }

        function setImg() {
            profile.style.backgroundImage = "url(" + img.value + " )";
            console.log(img.value);
            img.value = "";
        }

        function addParagraph() {
            const newpara = document.createElement9("p");
            newpara.textContent = "new paragraph";
            newdiv.appendChild(newpara)
        }

        const phones = []
        function addPhone() {
            const phonename = document.getElementById("phonename").value;
            const phone = document.getElementById("phone").value;
            console.log(phonename, phone)
            phones.push([phonename, phone])

            console.log(phones)
            const phonetable = document.getElementById("phonetable");

            phonetable.innerHTML += (`<tr>
                <td> ${phonetable.children.length} </td>
                <td> ${phonename} </td>
                <td> ${phone} </td>
            </tr>`)
        }

        function saveCSV() {
            const csvContent = phones.map(row => row.join(",")).join("\n"); // Convert array to CSV string
            const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "data.csv");
            link.style.visibility = "hidden";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>

</html>